<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1, shrink-to-fit=no">

    <title>Best Compress your image in KB | see live preview | online free</title>
    <meta name="description" content="imagecrc.com - Compress your image in KB and see live preview. | Special feature to make sign and passport size photo..."/>
    <meta name="keywords" content="Image, crop,compress, resize, convert, jpg,jpeg, png, gif, webp,cm,mm,inch,kb,sign and photo,crop passport size photo,crop sign,online free,online image resizer,image crop and compress online,image crop and resize online,image resizer in Kb,image resize in pixel,image resizer in cm,image resize in 20kb,image resize in inches,image crop 100Kb,convert png to jpg,convert jpeg to jpg,convert jpg to png,convert jpeg to png"/>
    <meta name="author" content="imageCRC"/>
    <meta name="robots" content="index, follow"/>
      
    <!-- link cropper.css and cropper.js files then only cropper work-->
   <link rel="stylesheet" href="../cropperjs/dist/cropper.css">
   <script src="../cropperjs/dist/cropper.js"></script>

  <link rel="icon" href="../images/myico.ico" type="image/icon type">


     <!-- Bootstrap CSS -->
     <link rel="stylesheet" href="../Bootstrap5/css/bootstrap.min.css">
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="../jQuery/jquery-3.2.1.min.js"></script>
    <script src="../Bootstrap5/js/bootstrap.js"></script>


   

    <style>
        
        body{
         background:#eeebeb;
        }
        #Header a:hover{
          color: #0d6efd;;
          text-decoration: underline;
          font-size: 1.5rem;
        }
        .active{
          color: #0d6efd !important;;
          text-decoration: underline;
        }
        #Header a{
          font-weight: 545;
          color: black;
          letter-spacing: .1rem;
        }

        .mynavitem>a{
        font: 1.3em Arial,Verdana,sans-serif;
       }  
        .mycontainer{
            margin-top: 0px;
            min-height: 80vh;
        }

      .input-img-wrapper {
        max-height: 500px ;
        max-width: 100%;
        display: flex;
        flex-flow: wrap;
        justify-content: center;
        background-color: #FFF;
        overflow-y: auto;
      }
      .input-img-wrapper>img {
       max-width: 100%;
       max-height: 100%;
      }
      .preview-img-wrapper{
        max-height: 500px ;
        width: 100%;
        display: flex;
        flex-flow: wrap;
        justify-content: center;
        background-color: #FFF;
        overflow-y: auto;
      }
      .preview-img-wrapper>img{
       max-width: 100%;
      }
      .hideme{
        display: none;
      }
      #inputFileBtn{
        background-color: #4d90fe;
        font-weight: 1000;
        font-size: 26px;
        border-radius: 1rem;
        color:#FFF;
        text-justify:center;
        font-family: 'Courier New', Courier, monospace;
      }
    #inputFileBtn:hover{
      font-size: 2rem;
    }

    
    .heading1{
        justify-content: center;
        font-size: 2.6rem;
        font-weight: 500;
       }
       .heading2{
         justify-content: center;
         font-size: 1.3rem;
         font-weight: 400;
         text-align: center;
         font-family: Verdana,sans-serif;
       }
       .makeblue{
        color: #4d90fe;
      
       }
   </style>

  </head>
  <body>

    <!-- body-->

   <div class="container-fluid px-0">
    <div id="Header" >
        <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-lg p-3 mb-3 bg-body rounded">
            <div class="container-fluid px-0">
              <a href="../index.html" class="navbar-brand text-decoration-none"> <img src="../images/mylogo.png" alt=""> <img src="../images/brandname.png" alt=""></a>

              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mymenu"><span class="navbar-toggler-icon" ></span></button>
               
                        <div class="collapse navbar-collapse"  id="mymenu">
                            <ul class="navbar-nav mx-auto">
                                <li class="nav-item mynavitem mx-2"><a href="../index.html" class="nav-link">Home</a> </li>
                                <li class="nav-item mynavitem mx-2"><a href="./compress.html" class="active nav-link">Compress Image</a> </li>
                                <li class="nav-item mynavitem mx-2"><a href="../resizewh/resizewh.html" class="nav-link">Resize Width & Height</a> </li>
                                <li class="nav-item mynavitem mx-2"><a href="../cropimage/cropimage.html" class="nav-link">Crop Image</a> </li>
                                <li class="nav-item mynavitem mx-2"><a href="../mingle/mingle.html" class="nav-link">Mingle</a> </li>
                                <li class="nav-item mynavitem mx-2"><a href="../convertimage/convertimage.html" class="nav-link">Convert</a> </li>
                            </ul>
                    </div>
             </div>
        </nav>  
    </div>
    </div>


<div class="container mycontainer ">
      <div class="row mx-auto col-md-8">
  

        <div class="row mx-auto px-0 py-2">
          <div class="col-12 ">
               <div class="row px-0 heading1 mb-2 text-center">Compress Image</div>
               <div class="row px-0"><p class="heading2">Compress <span class="makeblue"> JPG, PNG, JPEG, GIF, WEBP </span> image. Set  <span class="makeblue"> Compress % </span> according to your need. Compression reduces files size<span class="makeblue"> {KB,MB}</span>. View <span class="makeblue">preview </span> before download.</p></div>
          </div>            
        </div> 



      <div class="row mx-auto">
         <div class="col-md-12 px-0 py-2">
         
            <div class="row p-1">
              <div class="col-sm-8 col-lg-6 mx-auto">
              <input  onchange="showInputImage()" type="file" accept="image/*" class="form-control hideme" id="inputFiles">
              <button id="inputFileBtn" type="button" class="form-control btn" onclick="document.getElementById('inputFiles').click()">Select an Image</button>
               </div>
            </div>
            

            <div class="input-img-wrapper mt-2 p-1">
                <img id="loadingImage2" src="./loading_image.gif" class="hideme" alt="loading...">
              <img src="" id="inputImageShow" alt="">
            </div> 

         </div>
      </div>

       <div class="row mx-auto px-0">
         
        <div class="col-md-12 mx-0 py-2 px-0">
              
          <div class="row mx-0 px-0">
            <div class="col-md-12 px-0 hideme" id="statusMsg">
               <!--  here success error msg will show--> 
           </div>
         </div>

         <div class="row my-2">
           <div class="col-md-12">
             <div class="row">
           <div class="col-4 " style="align-self: center">
                <div class="row ">
                  <div class="col-12 ">
                     <h5 id="inputfileinKB" class="align-middle my-auto">  0 KB</h5>
                  </div>

                </div>       
           </div>
           <div class="col-4 d-flex justify-content-center my-1">
             <button type="button" id="compressBtn" class="btn btn-danger py-1">Compress</button>
           </div>
           <div class="col-4 " style="align-self: center">
                <div class="row mx-auto">
                  <div class="col-12 ">
                    <h5 id="outputfileinKB" class="align-middle my-auto  d-flex justify-content-end hideme">  0 KB</h5>
                  </div>

                </div>       
             </div>
           </div>
           </div>
       </div>
         
       <div class="row my-2">
         <div class="col-md-12">
        <div class="preview-img-wrapper p-1" id="croppedImageDiv">
            <img id="loadingImage" src="./loading_image.gif" class="hideme" alt="loading...">

          <img id="croppedImg"  name="image" src="" alt="">
        </div>
        </div>
     </div>

         <div class="row mt-3">
             <div class="col-md-12 d-flex justify-content-end"> 
             <button  id="downloadBtn" class="btn btn-success py-1 px-4 hideme">Download</button>
            </div>
         </div>
     </div>
   </div>


  </div>
</div>

<!-- footer-->
<div class="container-fluid bg-dark mt-4">
    
      <div class="row py-3" style="color: white;">
        <div class="col-12 d-flex justify-content-center"> </div>
      </div>
</div>

<script>


  var input_image = document.getElementById("inputImageShow");
  var input = document.getElementById("inputFiles");

  var croppedImg = document.getElementById('croppedImg');
 
  var downloadBtn = document.getElementById('downloadBtn')

  var compressBtn = document.getElementById('compressBtn')
  var croppedImageDiv  = document.getElementById('croppedImageDiv')
  var statusMsg = document.getElementById('statusMsg')

  var inputImageUrl="";

function showInputImage(){
  
   if (input.files[0]){
          var formData = new FormData();
          formData.append('image', input.files[0]);
          
          $('#statusMsg').hide() 
           $('#inputImageShow').hide()
          $('#loadingImage2').show()

          $.ajax('./uploadfile.php', {
            method: "POST",
            data: formData,
            processData: false,
            contentType: false,
            success: function (data) {

              var e = 1*data.split("||")[1];
              var filesize =getFileKBMB(parseFloat(e))
              document.getElementById('inputfileinKB').innerHTML = filesize
              
               inputImageUrl = data.split("||")[0];
              $('#inputImageShow').show()
               input_image.src = inputImageUrl;
              $('#loadingImage2').hide()
              refreshImage(input_image,inputImageUrl)

            },
            error: function () {
              console.log('Upload error');
              alert('upload error')
              $('#loadingImage2').hide()
              $('#inputImageshow').show()
            }
          });

   }
}

function refreshImage(imgElement, imgURL){    
  // create a new timestamp 
  var timestamp = new Date().getTime();  
  var queryString = "?t=" + timestamp;    
  imgElement.src = imgURL + queryString;    
} 

compressBtn.addEventListener("click", (event)=>{
     event.preventDefault()
     $('#statusMsg').hide()  

 if(inputImageUrl !== ""){

  var x;
  var compress=prompt("Please Enter (1-100)% to Compress");
  if (compress != null && !isNaN(compress) ){
     if(compress > 0 && compress <101) 
     {
         $('#croppedImg').hide()
         $('#loadingImage').show()
       
          var urlofimage = input_image.src
          urlofimage=urlofimage.split("?t=")[0];  // removing time stamp (time stamp added to reload image)

          var formData = new FormData();
          formData.append('filepath', urlofimage);
          formData.append('quality',(100-compress))
          $.ajax('compressImage.php', {
            method: "POST",
            data: formData,
            processData: false,
            contentType: false,
            success: function (response) {
            
              if(response.split("||")[0] === "error"){
                showCompressionFailedmsg()
                $('#loadingImage').hide(); 
               $('#croppedImg').show()
               console.log("error"+response)
                return 
              }

              var e = 1*(response.split("||")[1]);
              var filesize =getFileKBMB(parseFloat(e))
              document.getElementById('outputfileinKB').innerHTML = filesize

             refreshImage(croppedImg,response.split("||")[0])
             console.log(response)

             $('#downloadBtn').show()  // now download button must show
             $('#outputfileinKB').show()

             $('#croppedImg').show()
            $('#loadingImage').hide()
            },
            error: function () {
              console.log('Upload error');

               $('#loadingImage').hide(); 
               $('#croppedImg').show()
               showCompressionFailedmsg()
            }
          });

            }else{
              alert("Enter only number range in 1 to 100")
            }
     }
     else{
       alert("Enter only number range in 1 to 100")
     }

  }else{
    
       alert("********  First Select an Image...   ******")
  }

});

function showCompressionFailedmsg(){
                 
                 $('#statusMsg').empty().append('<div class="alert alert-danger alert-dismissible fade show" role="alert"><strong>Compression Failed...</strong><button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>');
                 $('#statusMsg').show()  


}


downloadBtn.addEventListener("click", (event)=>{
    event.preventDefault()
    

    let imgsrc = document.getElementById('croppedImg').src;
    console.log(imgsrc)
    if(imgsrc !== "")   // dynamically create anchor link and download
    {
                  const link = document.createElement('a');
                  link.href = imgsrc;
                  link.setAttribute('download', 'image.jpg');
                  document.body.appendChild(link);
                  link.click();   // click anchor so download start

    }
    
  });

function getFileKBMB(filebytes)
{
if(filebytes >= 1048576)
{
  filebytes = (filebytes/1048576).toFixed(2)
  filebytes = filebytes+" MB"
}
else{
  filebytes = (filebytes/1024).toFixed(2)
  filebytes = filebytes+" KB"
}
return filebytes
}

</script>
  
</body>



</html>